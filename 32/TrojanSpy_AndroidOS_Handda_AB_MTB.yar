
rule TrojanSpy_AndroidOS_Handda_AB_MTB{
	meta:
		description = "TrojanSpy:AndroidOS/Handda.AB!MTB,SIGNATURE_TYPE_DEXHSTR_EXT,02 00 02 00 03 00 00 "
		
	strings :
		$a_01_0 = {73 79 73 74 65 6d 2f 6c 69 62 20 70 6d 20 67 65 74 2d 69 6e 73 74 61 6c 6c 2d 6c 6f 63 61 74 69 6f 6e } //1 system/lib pm get-install-location
		$a_03_1 = {13 05 08 00 04 82 23 50 ?? ?? 12 01 21 04 34 41 03 00 11 00 22 04 ?? ?? 16 06 ff 00 c0 26 70 30 ?? ?? 64 07 6e 10 ?? ?? 04 00 0a 04 4f 04 00 01 c4 52 d8 01 01 01 } //1
		$a_03_2 = {1a 02 00 00 71 10 ?? ?? 05 00 0c 00 21 03 d8 01 03 ff 3b 01 ?? ?? 11 02 22 03 ?? ?? 71 10 ?? ?? 02 00 0c 04 70 20 ?? ?? 43 00 48 04 00 01 d5 44 ff 00 6e 20 ?? ?? 43 00 0c 03 6e 10 ?? ?? 03 00 0c 02 3d 01 ?? ?? 22 03 ?? ?? 71 10 ?? ?? 02 00 0c 04 70 20 ?? ?? 43 00 1a 04 ?? ?? 6e 20 ?? ?? 43 00 0c 03 6e 10 ?? ?? 03 00 0c 02 d8 01 01 ff } //1
	condition:
		((#a_01_0  & 1)*1+(#a_03_1  & 1)*1+(#a_03_2  & 1)*1) >=2
 
}