
rule Trojan_AndroidOS_GriftHorse_K_MTB{
	meta:
		description = "Trojan:AndroidOS/GriftHorse.K!MTB,SIGNATURE_TYPE_DEXHSTR_EXT,0f 00 0f 00 04 00 00 "
		
	strings :
		$a_03_0 = {43 00 14 04 ?? ?? ?? 7f 6e 20 ?? ?? 43 00 14 04 ?? ?? ?? 7f 6e 20 ?? ?? 43 00 0c 04 1f 04 ?? ?? 1a 00 ?? ?? 71 20 ?? ?? 04 00 6e 10 ?? ?? 04 00 0c 00 1a 01 ?? ?? 71 20 ?? ?? 10 00 12 11 6e 20 ?? ?? 10 00 22 00 ?? ?? 70 10 ?? ?? 00 00 6e 20 ?? ?? 04 00 22 00 ?? ?? 70 20 ?? ?? 30 00 1f 00 ?? ?? 6e 20 ?? ?? 04 00 6e 10 ?? ?? 03 00 0c 00 71 20 ?? ?? 40 00 6e 10 ?? ?? 03 00 0c 00 1a 02 ?? ?? 71 20 ?? ?? 20 00 0c 00 38 00 ?? ?? 1a 02 ?? ?? 71 30 ?? ?? 20 01 0a 01 38 01 ?? ?? 1a 00 ?? ?? 22 01 ?? ?? 70 10 ?? ?? 01 00 1a 02 ?? ?? 6e 20 ?? ?? 21 00 6e 20 ?? ?? 01 00 6e 10 ?? ?? 01 00 0c 00 6e 20 ?? ?? 04 00 } //10
		$a_03_1 = {21 00 14 02 ?? ?? 0a 7f 6e 20 ?? ?? 21 00 14 02 ?? ?? 07 7f 6e 20 ?? ?? 21 00 0c 02 1f 02 ?? ?? 5b 12 ?? ?? 6e 10 ?? ?? 02 00 0c 02 12 10 6e 20 ?? ?? 02 00 54 12 ?? ?? 22 00 ?? ?? 70 10 ?? ?? 00 00 6e 20 ?? ?? 02 00 54 12 ?? ?? 22 00 ?? ?? 70 10 ?? ?? 00 00 6e 20 ?? ?? 02 00 6e 10 ?? ?? 01 00 0c 02 54 10 ?? ?? 71 20 ?? ?? 02 00 } //10
		$a_03_2 = {21 00 14 02 ?? ?? 0c 7f 6e 20 ?? ?? 21 00 14 02 ?? ?? 09 7f 6e 20 ?? ?? 21 00 0c 02 1f 02 ?? ?? 5b 12 ?? ?? 6e 10 ?? ?? 02 00 0c 02 12 10 6e 20 ?? ?? 02 00 54 12 ?? ?? 22 00 ?? ?? 70 10 ?? ?? 00 00 6e 20 ?? ?? 02 00 54 12 ?? ?? 22 00 ?? ?? 70 20 ?? ?? 10 00 6e 20 ?? ?? 02 00 6e 10 ?? ?? 01 00 0c 02 54 10 ?? ?? 71 20 ?? ?? 02 00 54 12 ?? ?? 62 00 ?? ?? 6e 20 ?? ?? 02 00 } //10
		$a_03_3 = {70 73 3a 2f 2f 64 [0-17] 2e 63 6c 6f 75 64 66 72 6f 6e 74 2e 6e 65 74 2f 63 6f 6d 2e [0-35] 2e 68 74 6d 6c } //5
	condition:
		((#a_03_0  & 1)*10+(#a_03_1  & 1)*10+(#a_03_2  & 1)*10+(#a_03_3  & 1)*5) >=15
 
}