
rule Trojan_AndroidOS_DroidRoot_T_MTB{
	meta:
		description = "Trojan:AndroidOS/DroidRoot.T!MTB,SIGNATURE_TYPE_DEXHSTR_EXT,0c 00 0c 00 05 00 00 "
		
	strings :
		$a_00_0 = {72 61 67 65 61 67 61 69 6e 73 74 74 68 65 63 61 67 65 } //1 rageagainstthecage
		$a_00_1 = {7a 34 72 6f 6f 74 } //1 z4root
		$a_00_2 = {63 68 6f 77 6e 20 72 6f 6f 74 2e 72 6f 6f 74 20 73 79 73 74 65 6d 2f 62 69 6e 2f 73 75 5c 6e 63 68 6d 6f 64 20 36 37 35 35 20 2f 73 79 73 74 65 6d 2f 62 69 6e 2f 73 75 5c 6e } //1 chown root.root system/bin/su\nchmod 6755 /system/bin/su\n
		$a_03_3 = {00 12 0a 71 40 ?? ?? 98 7a 0c 03 1a 08 ?? 00 22 09 ?? 00 1a 0a ?? 00 70 20 ?? 00 a9 00 12 0a 44 0a 07 0a 6e 20 ?? ?? a9 00 0c 09 6e 10 ?? ?? 09 00 0c 09 71 20 ?? 00 98 00 22 05 ?? 00 70 20 ?? ?? 35 00 22 04 ?? 00 70 20 ?? ?? 34 00 22 08 ?? 00 70 30 ?? ?? b8 04 6e 10 ?? ?? 08 00 22 08 ?? 00 } //10
		$a_03_4 = {00 12 0b 71 40 ?? ?? a9 7b 0c 03 1a 09 ?? 00 22 09 ?? 00 1a 0a ?? 00 70 20 ?? ?? a9 00 12 0a 44 0a 07 0a 6e 20 ?? ?? a9 00 0c 09 6e 10 ?? ?? 09 00 0c 09 71 20 ?? 00 9c 00 22 05 ?? 00 70 20 ?? ?? 35 00 22 04 ?? 00 70 20 ?? ?? 34 00 22 09 ?? 00 70 40 ?? ?? d9 84 6e 10 ?? ?? 09 00 1a 00 ?? ?? 6e 10 ?? ?? 00 00 0c 09 6e 20 ?? ?? 95 00 6e 10 ?? ?? 05 00 15 09 04 7f 1a 0a ?? ?? 6e 10 ?? ?? 0d 00 0c 0b 71 30 ?? ?? a9 0b 14 09 02 00 04 7f 1a 0a ?? ?? 6e 10 ?? ?? 0d 00 0c 0b 71 30 ?? ?? a9 0b 14 09 03 00 04 7f 1a 0a ?? ?? 6e 10 ?? ?? 0d 00 0c 0b 71 30 ?? ?? a9 0b 22 09 ?? 00 } //10
	condition:
		((#a_00_0  & 1)*1+(#a_00_1  & 1)*1+(#a_00_2  & 1)*1+(#a_03_3  & 1)*10+(#a_03_4  & 1)*10) >=12
 
}