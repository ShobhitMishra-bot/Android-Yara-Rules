rule Android_Ransomware_and_Koler_Detection
{
    meta:
        author = "Fernando Denis, https://twitter.com/fdrg21, https://twitter.com/jsmesa"
        reference = "https://koodous.com/"
        description = "Detects Android ransomware behaviors and Koler malware variants"
        version = "1.0"
        date = "25-Jan-2025"

    strings:
        // Ransomware: Svpeng
        $ransomware_a = {6e 64 20 79 6f 75 72 27 73 20 64 65 76 69 63 65 20 77 69 6c 6c 20 72 65 62 6f 6f 74 20 61 6e 64}
        $ransomware_b = "ADD_DEVICE_ADMI"

        // Ransomware: Banker
        $banker_a = "!2,.B99^GGD&R-"
        $banker_b = "22922222222222222222Q^SAAWA"
        $banker_c = "t2222222222229222Q^SAAWA"

        // Koler Domains
        $koler_domain_1 = "police-scan-mobile.com"
        $koler_domain_2 = "police-secure-mobile.com"
        $koler_domain_3 = "mobile-policeblock.com"
        $koler_domain_4 = "police-strong-mobile.com"
        $koler_domain_5 = "video-porno-gratuit.eu"
        $koler_domain_6 = "video-sartex.us"
        $koler_domain_7 = "policemobile.biz"

        // Koler Builds
        $koler_build_id = "buildid"
        $koler_hash_a = "DCEF055EEE3F76CABB27B3BD7233F6E3"
        $koler_hash_b = "C143D55D996634D1B761709372042474"

        // Koler Classes
        $koler_find_valid_domain = "FIND_VALID_DOMAIN"
        $koler_random_id = "6589y459"

        // Koler.D Class
        $koler_class_zactivity = "ZActivity"
        $koler_class_runtime = "Lcom/android/zics/ZRuntimeInterface"

    condition:
        (
            // Ransomware conditions
            ($ransomware_a and $ransomware_b) or
            any of ($banker_a, $banker_b, $banker_c)
        ) or
        (
            // Koler domains
            any of ($koler_domain_*) or
            // Koler builds
            ($koler_build_id and ($koler_hash_a or $koler_hash_b)) or
            // Koler classes
            ($koler_find_valid_domain and $koler_random_id) or
            // Koler.D class
            ($koler_class_zactivity and $koler_class_runtime)
        )
}
